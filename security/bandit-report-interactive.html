<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Static Code Security Analysis</title>
  <style>
    body { font-family: Segoe UI, Arial, sans-serif; margin: 24px; }
    h1 { margin: 0 0 8px 0; }
    .controls { display: flex; gap: 12px; flex-wrap: wrap; margin: 12px 0 16px; align-items: center; }
    .spacer { flex: 1 1 auto; }
    select, input { padding: 6px 8px; font-size: 14px; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ddd; padding: 8px; vertical-align: top; }
    th { background: #f2f2f2; cursor: pointer; user-select: none; }
    tr:nth-child(even) { background: #fafafa; }
    .pill { padding: 2px 6px; border-radius: 4px; font-size: 12px; }
    .sev-high { background: #ffebee; color: #b71c1c; }
    .sev-med { background: #fff8e1; color: #8d6e00; }
    .sev-low { background: #e8f5e9; color: #1b5e20; }
    .code { white-space: pre-wrap; font-family: Consolas, monospace; font-size: 12px; }
    .muted { color: #666; }
  </style>
</head>
<body>
  <h1>Static Code Security Analysis</h1>
  <div class="muted">Bandit findings for local Python source files, including severity, confidence, CWE, and code context.</div>
  <div class="muted">Source: bandit-report.json | Generated at: 2026-02-14 14:00:29 +02:00 | Version: 2.0.1</div>

  <div class="controls">
    <label>Show:
      <select id="pageSize" onchange="changePageSize()">
        <option value="10" selected>10</option>
        <option value="25">25</option>
        <option value="50">50</option>
      </select>
    </label>
    <span class="muted" id="pageInfo"></span>
    <input id="search" type="text" placeholder="Search text or file" />
    <select id="severity">
      <option value="">All severities</option>
      <option value="HIGH">HIGH</option>
      <option value="MEDIUM">MEDIUM</option>
      <option value="LOW">LOW</option>
    </select>
    <select id="confidence">
      <option value="">All confidence</option>
      <option value="HIGH">HIGH</option>
      <option value="MEDIUM">MEDIUM</option>
      <option value="LOW">LOW</option>
    </select>
    <span class="spacer"></span>
    <button type="button" onclick="previousPage()">Previous</button>
    <button type="button" onclick="nextPage()">Next</button>
  </div>

  <table id="tbl">
    <thead>
      <tr>
        <th data-key="severity">Severity</th>
        <th data-key="confidence">Confidence</th>
        <th data-key="test_id">Test ID</th>
        <th data-key="file">File</th>
        <th data-key="line">Line</th>
        <th data-key="text">Issue</th>
        <th data-key="cwe">CWE</th>
        <th data-key="more_info">More Info</th>
        <th>Code</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

<script>
const rows = [{"severity": "LOW", "confidence": "HIGH", "test_id": "B404", "test_name": "blacklist", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 7, "text": "Consider possible security implications associated with the subprocess module.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/blacklists/blacklist_imports.html#b404-import-subprocess", "code": "6 import logging\n7 import subprocess\n8 import tempfile\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B112", "test_name": "try_except_continue", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 115, "text": "Try, Except, Continue detected.", "cwe": 703, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b112_try_except_continue.html", "code": "114             return dt.replace(tzinfo=timezone.utc)\n115         except Exception:\n116             continue\n117     try:\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B110", "test_name": "try_except_pass", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 140, "text": "Try, Except, Pass detected.", "cwe": 703, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b110_try_except_pass.html", "code": "139             conn.commit()\n140     except Exception:\n141         pass\n142 \n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B110", "test_name": "try_except_pass", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 154, "text": "Try, Except, Pass detected.", "cwe": 703, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b110_try_except_pass.html", "code": "153             return LDAP_SOURCE_CACHE[key]\n154     except Exception:\n155         pass\n156     if app.config.get(\"LDAP_ENABLED\") and ldap_user_exists(username, app.config, app.logger):\n"}, {"severity": "LOW", "confidence": "MEDIUM", "test_id": "B105", "test_name": "hardcoded_password_string", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 275, "text": "Possible hardcoded password: 'marketing'", "cwe": 259, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b105_hardcoded_password_string.html", "code": "274 app.config[\"SQLALCHEMY_TRACK_MODIFICATIONS\"] = False\n275 app.config[\"SECRET_KEY\"] = \"marketing\"  # Replace with a secure unique secret in production\n276 \n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B607", "test_name": "start_process_with_partial_path", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 476, "text": "Starting a process with a partial executable path", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b607_start_process_with_partial_path.html", "code": "475 \n476             proc = subprocess.run(\n477                 [\"openssl\", \"x509\", \"-in\", path, \"-noout\", \"-text\"],\n478                 capture_output=True, text=True\n479             )\n480             # clean up immediately\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 476, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "475 \n476             proc = subprocess.run(\n477                 [\"openssl\", \"x509\", \"-in\", path, \"-noout\", \"-text\"],\n478                 capture_output=True, text=True\n479             )\n480             # clean up immediately\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B607", "test_name": "start_process_with_partial_path", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 481, "text": "Starting a process with a partial executable path", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b607_start_process_with_partial_path.html", "code": "480             # clean up immediately\n481             try: subprocess.run([\"rm\", \"-f\", path])\n482             except: pass\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 481, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "480             # clean up immediately\n481             try: subprocess.run([\"rm\", \"-f\", path])\n482             except: pass\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B110", "test_name": "try_except_pass", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 482, "text": "Try, Except, Pass detected.", "cwe": 703, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b110_try_except_pass.html", "code": "481             try: subprocess.run([\"rm\", \"-f\", path])\n482             except: pass\n483 \n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 525, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "524         cmd.extend([\"-in\", f.name, \"-noout\", \"-text\"])\n525         p = subprocess.run(cmd, capture_output=True, text=True)\n526         return p.stdout or p.stderr\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B607", "test_name": "start_process_with_partial_path", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 568, "text": "Starting a process with a partial executable path", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b607_start_process_with_partial_path.html", "code": "567     try:\n568         proc = subprocess.run(\n569             [\"openssl\", \"x509\", \"-in\", path, \"-noout\", \"-text\"],\n570             capture_output=True, text=True\n571         )\n572         text = proc.stdout or proc.stderr\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 568, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "567     try:\n568         proc = subprocess.run(\n569             [\"openssl\", \"x509\", \"-in\", path, \"-noout\", \"-text\"],\n570             capture_output=True, text=True\n571         )\n572         text = proc.stdout or proc.stderr\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B110", "test_name": "try_except_pass", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 669, "text": "Try, Except, Pass detected.", "cwe": 703, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b110_try_except_pass.html", "code": "668             )\n669         except Exception:\n670             pass\n671     flash('Challenge password deleted.', 'success')\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B112", "test_name": "try_except_continue", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 710, "text": "Try, Except, Continue detected.", "cwe": 703, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b112_try_except_continue.html", "code": "709                             to_delete.append(row['value'])\n710                     except Exception:\n711                         continue\n712         if to_delete:\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B110", "test_name": "try_except_pass", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 725, "text": "Try, Except, Pass detected.", "cwe": 703, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b110_try_except_pass.html", "code": "724                 )\n725             except Exception:\n726                 pass\n727             flash(f\"Deleted {len(to_delete)} expired challenge passwords.\", \"success\")\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B110", "test_name": "try_except_pass", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 775, "text": "Try, Except, Pass detected.", "cwe": 703, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b110_try_except_pass.html", "code": "774                     expired_flag = datetime.now(timezone.utc) > expires_dt\n775                 except Exception:\n776                     pass\n777         result.append({\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B110", "test_name": "try_except_pass", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 851, "text": "Try, Except, Pass detected.", "cwe": 703, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b110_try_except_pass.html", "code": "850         )\n851     except Exception:\n852         pass\n853     return jsonify({\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B110", "test_name": "try_except_pass", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 904, "text": "Try, Except, Pass detected.", "cwe": 703, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b110_try_except_pass.html", "code": "903             )\n904         except Exception:\n905             pass\n906         session['generated_challenge_password'] = {\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B110", "test_name": "try_except_pass", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 956, "text": "Try, Except, Pass detected.", "cwe": 703, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b110_try_except_pass.html", "code": "955                     expired = True\n956             except Exception:\n957                 pass\n958         challenge_passwords.append({\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B607", "test_name": "start_process_with_partial_path", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 1377, "text": "Starting a process with a partial executable path", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b607_start_process_with_partial_path.html", "code": "1376         fallback_err = None\n1377         openssh_proc = subprocess.run(\n1378             [\"ssh-keygen\", \"-i\", \"-m\", \"PKCS8\", \"-f\", pem_path],\n1379             capture_output=True,\n1380             text=True\n1381         )\n1382         openssh_pub = openssh_proc.stdout.strip()\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 1377, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "1376         fallback_err = None\n1377         openssh_proc = subprocess.run(\n1378             [\"ssh-keygen\", \"-i\", \"-m\", \"PKCS8\", \"-f\", pem_path],\n1379             capture_output=True,\n1380             text=True\n1381         )\n1382         openssh_pub = openssh_proc.stdout.strip()\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B607", "test_name": "start_process_with_partial_path", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 1385, "text": "Starting a process with a partial executable path", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b607_start_process_with_partial_path.html", "code": "1384             try:\n1385                 openssh_pub = subprocess.run(\n1386                     [\"ssh-keygen\", \"-i\", \"-m\", \"PEM\", \"-f\", pem_path],\n1387                     check=True,\n1388                     capture_output=True,\n1389                     text=True\n1390                 ).stdout.strip()\n1391             except subprocess.CalledProcessError as e:\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 1385, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "1384             try:\n1385                 openssh_pub = subprocess.run(\n1386                     [\"ssh-keygen\", \"-i\", \"-m\", \"PEM\", \"-f\", pem_path],\n1387                     check=True,\n1388                     capture_output=True,\n1389                     text=True\n1390                 ).stdout.strip()\n1391             except subprocess.CalledProcessError as e:\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B607", "test_name": "start_process_with_partial_path", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 1420, "text": "Starting a process with a partial executable path", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b607_start_process_with_partial_path.html", "code": "1419             try:\n1420                 rfc4716_pub = subprocess.run(\n1421                     [\"ssh-keygen\", \"-e\", \"-m\", \"RFC4716\", \"-f\", tmp_pub_path],\n1422                     check=True,\n1423                     capture_output=True,\n1424                     text=True\n1425                 ).stdout.strip()\n1426                 if rfc4716_pub:\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 1420, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "1419             try:\n1420                 rfc4716_pub = subprocess.run(\n1421                     [\"ssh-keygen\", \"-e\", \"-m\", \"RFC4716\", \"-f\", tmp_pub_path],\n1422                     check=True,\n1423                     capture_output=True,\n1424                     text=True\n1425                 ).stdout.strip()\n1426                 if rfc4716_pub:\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B607", "test_name": "start_process_with_partial_path", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 1463, "text": "Starting a process with a partial executable path", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b607_start_process_with_partial_path.html", "code": "1462             try:\n1463                 rfc4716_pub = subprocess.run(\n1464                     [\"ssh-keygen\", \"-e\", \"-m\", \"RFC4716\", \"-f\", tmp_pub_path],\n1465                     check=True,\n1466                     capture_output=True,\n1467                     text=True\n1468                 ).stdout.strip()\n1469                 if rfc4716_pub:\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 1463, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "1462             try:\n1463                 rfc4716_pub = subprocess.run(\n1464                     [\"ssh-keygen\", \"-e\", \"-m\", \"RFC4716\", \"-f\", tmp_pub_path],\n1465                     check=True,\n1466                     capture_output=True,\n1467                     text=True\n1468                 ).stdout.strip()\n1469                 if rfc4716_pub:\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B607", "test_name": "start_process_with_partial_path", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 1501, "text": "Starting a process with a partial executable path", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b607_start_process_with_partial_path.html", "code": "1500     }\n1501     rsa_proc = subprocess.run(\n1502         [\"openssl\", \"rsa\", \"-in\", pem_path, \"-traditional\"],\n1503         capture_output=True,\n1504         text=True\n1505     )\n1506     if rsa_proc.returncode == 0 and rsa_proc.stdout.strip():\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 1501, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "1500     }\n1501     rsa_proc = subprocess.run(\n1502         [\"openssl\", \"rsa\", \"-in\", pem_path, \"-traditional\"],\n1503         capture_output=True,\n1504         text=True\n1505     )\n1506     if rsa_proc.returncode == 0 and rsa_proc.stdout.strip():\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B607", "test_name": "start_process_with_partial_path", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 1509, "text": "Starting a process with a partial executable path", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b607_start_process_with_partial_path.html", "code": "1508         return formats\n1509     ec_proc = subprocess.run(\n1510         [\"openssl\", \"ec\", \"-in\", pem_path],\n1511         capture_output=True,\n1512         text=True\n1513     )\n1514     if ec_proc.returncode == 0 and ec_proc.stdout.strip():\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 1509, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "1508         return formats\n1509     ec_proc = subprocess.run(\n1510         [\"openssl\", \"ec\", \"-in\", pem_path],\n1511         capture_output=True,\n1512         text=True\n1513     )\n1514     if ec_proc.returncode == 0 and ec_proc.stdout.strip():\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 1607, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "1606                         cmd = [\"openssl\", \"pkey\", \"-in\", path, \"-noout\", \"-text\"]\n1607                         proc = subprocess.run(cmd, capture_output=True, text=True)\n1608                         out, err = proc.stdout, proc.stderr\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 1612, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "1611                         cmd = [\"openssl\", \"pkey\", \"-pubin\", \"-in\", path, \"-noout\", \"-text\"]\n1612                         proc = subprocess.run(cmd, capture_output=True, text=True)\n1613                         out, err = proc.stdout, proc.stderr\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 1618, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "1617                             cmd = [\"openssl\", \"ocsp\", \"-respin\", path, \"-noout\", \"-text\", \"-noverify\"]\n1618                             proc = subprocess.run(cmd, capture_output=True, text=True)\n1619                             out, err = proc.stdout, proc.stderr\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 1623, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "1622                             cmd = [\"openssl\", \"ocsp\", \"-respin\", \"-\", \"-text\", \"-noverify\"]\n1623                             proc = subprocess.run(cmd, input=der, capture_output=True)\n1624                             out = proc.stdout.decode(\"utf-8\", errors=\"ignore\")\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 1630, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "1629                             cmd = [\"openssl\", \"ocsp\", \"-reqin\", path, \"-noout\", \"-text\", \"-noverify\"]\n1630                             proc = subprocess.run(cmd, capture_output=True, text=True)\n1631                             out, err = proc.stdout, proc.stderr\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 1635, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "1634                             cmd = [\"openssl\", \"ocsp\", \"-reqin\", \"-\", \"-text\", \"-noverify\"]\n1635                             proc = subprocess.run(cmd, input=der, capture_output=True)\n1636                             out = proc.stdout.decode(\"utf-8\", errors=\"ignore\")\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 1641, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "1640                         cmd = [\"openssl\", *subcmd, path]\n1641                         proc = subprocess.run(cmd, capture_output=True, text=True)\n1642                         out, err = proc.stdout, proc.stderr\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 1649, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "1648                             cmd = [\"openssl\", subcmd[0], \"-inform\", \"DER\", \"-in\", path] + subcmd[1:]\n1649                         proc = subprocess.run(cmd, capture_output=True, text=True)\n1650                         out, err = proc.stdout, proc.stderr\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B607", "test_name": "start_process_with_partial_path", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 1844, "text": "Starting a process with a partial executable path", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b607_start_process_with_partial_path.html", "code": "1843         # Run the OpenSSL command to get the raw CRL details.\n1844         proc = subprocess.Popen(\n1845             [\"openssl\", \"crl\", \"-noout\", \"-text\", \"-in\", app.config[\"CRL_PATH\"] ],\n1846             stdout=subprocess.PIPE,\n1847             stderr=subprocess.PIPE\n1848         )\n1849         stdout, stderr = proc.communicate()\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 1844, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "1843         # Run the OpenSSL command to get the raw CRL details.\n1844         proc = subprocess.Popen(\n1845             [\"openssl\", \"crl\", \"-noout\", \"-text\", \"-in\", app.config[\"CRL_PATH\"] ],\n1846             stdout=subprocess.PIPE,\n1847             stderr=subprocess.PIPE\n1848         )\n1849         stdout, stderr = proc.communicate()\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B110", "test_name": "try_except_pass", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 2066, "text": "Try, Except, Pass detected.", "cwe": 703, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b110_try_except_pass.html", "code": "2065                 )\n2066             except Exception:\n2067                 pass\n2068             flash(\"Policy created\", \"success\")\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B110", "test_name": "try_except_pass", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 2138, "text": "Try, Except, Pass detected.", "cwe": 703, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b110_try_except_pass.html", "code": "2137                 )\n2138             except Exception:\n2139                 pass\n2140             flash(\"Policy updated\", \"success\")\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B110", "test_name": "try_except_pass", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 2164, "text": "Try, Except, Pass detected.", "cwe": 703, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b110_try_except_pass.html", "code": "2163             )\n2164         except Exception:\n2165             pass\n2166         flash(\"Policy deleted\", \"success\")\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 2473, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "2472             try:\n2473                 subprocess.run(cmd, check=True, capture_output=True, text=True)\n2474                 app.logger.trace(f\"[L2011] submit: OpenSSL command executed successfully\")\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 2568, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "2567             ])\n2568             subprocess.run(cmd, check=True, capture_output=True, text=True)\n2569     except subprocess.CalledProcessError as e:\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B110", "test_name": "try_except_pass", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 2768, "text": "Try, Except, Pass detected.", "cwe": 703, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b110_try_except_pass.html", "code": "2767                     requests_serials.append(sn)\n2768         except Exception:\n2769             pass  # ignore, we already have the first request\n2770 \n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B110", "test_name": "try_except_pass", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 2823, "text": "Try, Except, Pass detected.", "cwe": 703, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b110_try_except_pass.html", "code": "2822                     break\n2823         except Exception:\n2824             pass\n2825 \n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B607", "test_name": "start_process_with_partial_path", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 2972, "text": "Starting a process with a partial executable path", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b607_start_process_with_partial_path.html", "code": "2971 \n2972     subprocess.run([\n2973         \"openssl\", \"crl2pkcs7\",\n2974         \"-nocrl\",\n2975         \"-certfile\", app.config[\"CHAIN_FILE_PATH\"],     # full chain PEM\n2976         \"-outform\", \"DER\",\n2977         \"-out\", p7_path\n2978     ], check=True)\n2979 \n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 2972, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "2971 \n2972     subprocess.run([\n2973         \"openssl\", \"crl2pkcs7\",\n2974         \"-nocrl\",\n2975         \"-certfile\", app.config[\"CHAIN_FILE_PATH\"],     # full chain PEM\n2976         \"-outform\", \"DER\",\n2977         \"-out\", p7_path\n2978     ], check=True)\n2979 \n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 3097, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "3096             app.logger.debug(f\"EST: OpenSSL CLI command: {cmd}\")\n3097             subprocess.run(cmd, check=True, capture_output=True, text=True)\n3098 \n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B110", "test_name": "try_except_pass", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 3107, "text": "Try, Except, Pass detected.", "cwe": 703, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b110_try_except_pass.html", "code": "3106             os.unlink(cert_filename)\n3107         except Exception:\n3108             pass\n3109 \n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B607", "test_name": "start_process_with_partial_path", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 3145, "text": "Starting a process with a partial executable path", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b607_start_process_with_partial_path.html", "code": "3144     pkcs7_path = os.path.join(\"pki-misc\", \"est_cert_chain.p7\")\n3145     subprocess.run([\n3146         \"openssl\", \"crl2pkcs7\",\n3147         \"-nocrl\",\n3148         \"-certfile\", signed_cert_path,\n3149         \"-outform\", \"DER\",\n3150         \"-out\", pkcs7_path\n3151     ], check=True)\n3152 \n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 3145, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "3144     pkcs7_path = os.path.join(\"pki-misc\", \"est_cert_chain.p7\")\n3145     subprocess.run([\n3146         \"openssl\", \"crl2pkcs7\",\n3147         \"-nocrl\",\n3148         \"-certfile\", signed_cert_path,\n3149         \"-outform\", \"DER\",\n3150         \"-out\", pkcs7_path\n3151     ], check=True)\n3152 \n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B607", "test_name": "start_process_with_partial_path", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 3180, "text": "Starting a process with a partial executable path", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b607_start_process_with_partial_path.html", "code": "3179         # Extract public key from certificate\n3180         proc = subprocess.run(\n3181             [\"openssl\", \"x509\", \"-in\", cert_path, \"-pubkey\", \"-noout\"],\n3182             capture_output=True,\n3183             text=True,\n3184         )\n3185         if proc.returncode != 0:\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 3180, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "3179         # Extract public key from certificate\n3180         proc = subprocess.run(\n3181             [\"openssl\", \"x509\", \"-in\", cert_path, \"-pubkey\", \"-noout\"],\n3182             capture_output=True,\n3183             text=True,\n3184         )\n3185         if proc.returncode != 0:\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B607", "test_name": "start_process_with_partial_path", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 3203, "text": "Starting a process with a partial executable path", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b607_start_process_with_partial_path.html", "code": "3202         try:\n3203             pub_proc = subprocess.run(\n3204                 [\"openssl\", \"pkey\", \"-in\", key_path, \"-pubout\"],\n3205                 capture_output=True,\n3206                 text=True,\n3207             )\n3208             if pub_proc.returncode != 0:\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 3203, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "3202         try:\n3203             pub_proc = subprocess.run(\n3204                 [\"openssl\", \"pkey\", \"-in\", key_path, \"-pubout\"],\n3205                 capture_output=True,\n3206                 text=True,\n3207             )\n3208             if pub_proc.returncode != 0:\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B603", "test_name": "subprocess_without_shell_equals_true", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 3266, "text": "subprocess call - check for execution of untrusted input.", "cwe": 78, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b603_subprocess_without_shell_equals_true.html", "code": "3265     try:\n3266         proc = subprocess.run(cmd, capture_output=True, text=True)\n3267         if proc.returncode != 0:\n"}, {"severity": "LOW", "confidence": "HIGH", "test_id": "B110", "test_name": "try_except_pass", "file": "C:\\Users\\uzi\\Downloads\\projects\\PKI\\app.py", "line": 3398, "text": "Try, Except, Pass detected.", "cwe": 703, "more_info": "https://bandit.readthedocs.io/en/1.9.3/plugins/b110_try_except_pass.html", "code": "3397         log_user_event('reset_password', current_user.id, {'by': current_user.id, 'username': current_user.username, 'actor_username': current_user.username})\n3398     except Exception:\n3399         pass\n3400     flash(\"Password changed successfully.\", \"success\")\n"}];
let sortKey = 'severity';
let sortAsc = true;
let currentPage = 1;
let pageSize = 10;
let filteredRows = rows.slice();

function sevClass(sev) {
  if (sev === 'HIGH') return 'sev-high';
  if (sev === 'MEDIUM') return 'sev-med';
  return 'sev-low';
}

function render(resetPage = false) {
  const q = document.getElementById('search').value.toLowerCase();
  const sev = document.getElementById('severity').value;
  const conf = document.getElementById('confidence').value;

  filteredRows = rows.filter(r => {
    const hay = (r.text + ' ' + r.file + ' ' + r.test_id + ' ' + r.test_name + ' ' + r.code).toLowerCase();
    if (q && !hay.includes(q)) return false;
    if (sev && r.severity !== sev) return false;
    if (conf && r.confidence !== conf) return false;
    return true;
  });

  filteredRows.sort((a,b) => {
    const av = a[sortKey] ?? '';
    const bv = b[sortKey] ?? '';
    if (av === bv) return 0;
    if (sortAsc) return av > bv ? 1 : -1;
    return av < bv ? 1 : -1;
  });

  if (resetPage) currentPage = 1;
  renderPage(currentPage);
}

function renderPage(page) {
  const total = filteredRows.length;
  const totalPages = Math.max(1, Math.ceil(total / pageSize));
  currentPage = Math.min(Math.max(1, page), totalPages);
  const start = (currentPage - 1) * pageSize;
  const end = start + pageSize;
  const tbody = document.querySelector('#tbl tbody');
  tbody.innerHTML = '';
  for (const r of filteredRows.slice(start, end)) {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td><span class="pill ${sevClass(r.severity)}">${r.severity}</span></td>
      <td>${r.confidence}</td>
      <td>${r.test_id}</td>
      <td>${r.file}</td>
      <td>${r.line}</td>
      <td>${r.text}</td>
      <td>${r.cwe}</td>
      <td>${r.more_info}</td>
      <td class="code">${r.code}</td>
    `;
    tbody.appendChild(tr);
  }
  const shownStart = total === 0 ? 0 : start + 1;
  const shownEnd = Math.min(end, total);
  document.getElementById('pageInfo').textContent = `Page ${currentPage}/${totalPages} | Showing ${shownStart}-${shownEnd}`;
}

for (const el of ['search','severity','confidence']) {
  document.getElementById(el).addEventListener('input', () => render(true));
  document.getElementById(el).addEventListener('change', () => render(true));
}

document.querySelectorAll('th[data-key]').forEach(th => {
  th.addEventListener('click', () => {
    const key = th.getAttribute('data-key');
    if (sortKey === key) {
      sortAsc = !sortAsc;
    } else {
      sortKey = key;
      sortAsc = true;
    }
    render(false);
  });
});

function changePageSize() {
  pageSize = parseInt(document.getElementById('pageSize').value, 10) || 10;
  render(true);
}

function nextPage() {
  renderPage(currentPage + 1);
}

function previousPage() {
  renderPage(currentPage - 1);
}

render(true);
</script>
</body>
</html>
